<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
    <link href="https://unpkg.com/material-components-web@v4.0.0/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@v4.0.0/dist/material-components-web.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <style>
        :root {
            --mdc-theme-primary: navy;
        }
        body {
            margin: 0;
        }
        main {
            margin-left: 8px;
        }
        .view {
            display: none;
        }
        .template {
            display: none;
        }
				
    </style>

</head>

<body>

    <header class="mdc-top-app-bar">
        <div class="mdc-top-app-bar__row">
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                <span class="mdc-top-app-bar__title">Project 4 Coronavirus</span>
            </section>
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                <button id="page1" class="material-icons mdc-top-app-bar__action-item mdc-icon-button" aria-label="Display Chart">bar_chart</button>
                <button id="page2" class="material-icons mdc-top-app-bar__action-item mdc-icon-button" aria-label="Display Table">grid_on</button>
                <button id="page3" class="material-icons mdc-top-app-bar__action-item mdc-icon-button" aria-label="Show Map">location_on</button>
            </section>
        </div>
    </header>



    <main class="mdc-top-app-bar--fixed-adjust">
	</main>


        <h1 style="font-family:sans-serif;">Hello and welcome.</h1>
		<p style="font-family:sans-serif;">Select and submit a maximum of five countries. Then hit the display button. (Confirmed Cases right now)</p>
		<p style="font-family:sans-serif;">You can use the buttons on the top right to show a data table, or a Google chart. (Confirmed Cases right now)</p>
        
	
	<!-- Give items an id to query -->
        <input list="countries" id="countryContainer">
        <datalist id="countries">
            <option value="">
        </datalist>
		<input type="submit" id="Submit">
		
	
	
<div class="mdc-data-table">
  <table class="mdc-data-table__table" aria-label="Dessert calories">
    <thead>
      <tr class="mdc-data-table__header-row">
        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Date </th>
        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Carbs (g)</th>
        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Protein (g)</th>
        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Comments</th>
      </tr>
    </thead>
    <tbody class="mdc-data-table__content">
      <tr class="mdc-data-table__row">
        <td class="mdc-data-table__cell">Frozen yogurt</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">24</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">4.0</td>
        <td class="mdc-data-table__cell">Super tasty</td>
      </tr>
      <tr class="mdc-data-table__row">
        <td class="mdc-data-table__cell">Ice cream sandwich</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">37</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">4.33333333333</td>
        <td class="mdc-data-table__cell">I like ice cream more</td>
      </tr>
      <tr class="mdc-data-table__row">
        <td class="mdc-data-table__cell">Eclair</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">24</td>
        <td class="mdc-data-table__cell mdc-data-table__cell--numeric">6.0</td>
        <td class="mdc-data-table__cell">New filing flavor</td>
      </tr>
    </tbody>
  </table>
</div>
	
		        <div id="data">
            <!-- Incorrectly copied from MDC so added classes after mdc-list.. -->
            <ul class="mdc-list mdc-list--two-line mdc-list--avatar-list">
                <!-- Forgot to add "template" class. -->
                <li class="template mdc-list-item mdc-ripple-upgraded">
                    <span class="mdc-list-item__graphic material-icons" aria-hidden="true"></span>
                    <span class="mdc-list-item__text">
			<span class="mdc-list-item__primary-text"></span>
                    <span class="mdc-list-item__secondary-text"></span>
                    </span>
                </li>
			</ul>

        </div>
        <div>
            <button class="mdc-button">
                <div class="mdc-button__ripple" id="displayButton"></div>
                <span class="mdc-button__label">Display Total Cases</span>
            </button>
        </div>
        <canvas id="myChart" width="100" height="100"></canvas>


</body>

<script src="Chart.js"></script>
<script>
	
/*-------------------- FUNCTION SECTION --------------------*/
    function addData(chart, label, data) {
        chart.data.labels.push(label);
        chart.data.datasets.forEach((dataset) => {
            dataset.data.push(data);
        });
        chart.update();
    }

    function removeData(chart) {
        chart.data.labels.pop();
        chart.data.datasets.forEach((dataset) => {
            dataset.data.pop();
        });
        chart.update();
    }
	
    const displayData = (context, numbersArray, countriesArray) => {
        var myChart = new Chart(context, {
            type: 'bar',
            data: {
                labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                datasets: [{
                    label: 'Total Cases',
                    data: [12, 19, 3, 5, 2, 3],
                    backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)'],
                    borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)'],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });
        removeData(myChart);
        for(let i = 0; i < numbersArray.length; i++) {
            addData(myChart, countriesArray[i], numbersArray[i]);
        }
    }
	
	
	/*-------------------- END FUNCTION SECTION --------------------*/
	
	/*-------------------- PAGE ONE --------------------*/
	/*-------------------- PAGE ONE --------------------*/
	
	// Declare variables.
    let ctx = document.querySelector('#myChart');
    let countryData;
    let countryList = [];
    let deathsList = [];
    let totalDeaths = 0;
	
    // Section to fill the list with countries.
    let apiEndPoint = "https://pomber.github.io/covid19/timeseries.json";
	
	/*-------------------- FETCH AND BUILD --------------------*/
    fetch(apiEndPoint).then(response => {
        return response.json()
    }).then(json => {
        // Turn countryData = json object.
        countryData = json;
        //             console.log(countryData);
        // Find the node that contains the list.
        let theList = document.querySelector("#countries");
        //             console.log(theList);
        // Iterate through the json object. 'item' = country name.
        for(item in countryData) {
            // Clone the item inside the list.
            let opcione = document.createElement('option');
            opcione.value = item;
            theList.appendChild(opcione);
        }
		
        // Build the list that displays on the page while growing the arrays needed to store data.
        // Event listener for submit button.
        let submitButton = document.querySelector("#Submit");
        submitButton.addEventListener("click", event => {
            let textBox = document.querySelector("#countryContainer");
            let chosenCountry = textBox.value;
            let chosenCountryDeaths = 0;
            if(chosenCountry != "") {
                // Clone template
                let clone = document.querySelector("div#data li.template").cloneNode(true);
                // Add country to array after checking if it is there or not.
                let boolean = countryList.includes(chosenCountry);
                if(!boolean) {
                    countryList.push(chosenCountry);
                    // Remove template class from clone.
                    // 
                    clone.classList.remove("template");
                    // Update the value
                    clone.querySelector(".mdc-list-item__primary-text").textContent = chosenCountry;
                    clone.querySelector(".mdc-list-item__secondary-text").textContent = chosenCountry + "'s most recent data.";
                    // Append to list.
                    document.querySelector("div#data ul.mdc-list").appendChild(clone);
                    for(item of countryData[chosenCountry]) {
                        totalDeaths = totalDeaths + item['confirmed'];
                    }
                    deathsList.push(totalDeaths);
                }
            }
        })
		
	/*-------------------- DISPLAY CHART --------------------*/
        let displayButton = document.querySelector("#displayButton");
        displayButton.addEventListener("click", event => {
            console.log('display');
            console.log(deathsList);
            displayData(ctx, deathsList, countryList);
        })
    })
	/*-------------------- END PAGE ONE --------------------*/
	/*-------------------- END PAGE ONE --------------------*/

	
	/*-------------------- PAGE TWO --------------------*/
	/*-------------------- PAGE TWO --------------------*/
	

	/*-------------------- NAVIGATION --------------------*/
	let p1Button = document.querySelector("#page1");
	p1Button.addEventListener("click", event => { console.log("SO");})
	let p2Button = document.querySelector("#page2");
	p2Button.addEventListener("click", event => { 
		console.log("YOU");
	let table = document.querySelector(".mdc-data-table")
		table.style.visibility = "hidden";
	})
	let p3Button = document.querySelector("#page3");
	p3Button.addEventListener("click", event => { console.log("WANNA BE A MILLIONAIRE");})

	
</script>

</html>